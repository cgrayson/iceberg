// Generated by CoffeeScript 1.3.1
(function() {
  var $, SIZE_BUTTONS, get_size_setting, highlight_big_folders, highlight_folder, toggle_folder, toggle_label;

  $ = jQuery;

  SIZE_BUTTONS = {
    btn1mb: /[0-9][0-9]*M|.*G|.*T/,
    btn10mb: /[0-9][0-9][0-9]*M|.*G|.*T/,
    btn100mb: /[0-9][0-9][0-9]M|.*G|.*T/,
    btn1gb: /[0-9][0-9]*G|.*T/,
    btn10gb: /[0-9][0-9][0-9]*G|.*T/,
    btn100gb: /[0-9][0-9][0-9]G|.*T/
  };

  $(function() {
    $('#size-buttons button').click(function() {
      return highlight_big_folders(SIZE_BUTTONS[$(this).attr('id')]);
    });
    $('.filebrowser button.enabled').click(function() {
      return toggle_folder($(this));
    });
    highlight_folder(get_size_setting(), $('#folders').children(':first').children('.size'));
    $('div#folders > div.folder > button').click();
    return $('#loading').hide();
  });

  get_size_setting = function() {
    return SIZE_BUTTONS[$('#size-buttons .btn.active').attr('id')];
  };

  toggle_folder = function(element) {
    var open, subfolder;
    subfolder = element.parent().next("div");
    subfolder.toggle();
    open = element.parent().data('open');
    if (open == null) {
      open = false;
    }
    element.parent().data('open', !open);
    toggle_label(element);
    return highlight_big_folders(get_size_setting(), subfolder);
  };

  toggle_label = function(element) {
    element.children(":first").toggleClass('icon-folder-open');
    return element.children(":first").toggleClass('icon-folder-close');
  };

  highlight_folder = function(size_regex, element) {
    if (size_regex.test(element.text())) {
      return element.prev('button').addClass('btn-danger');
    } else {
      return element.prev('button').removeClass('btn-danger');
    }
  };

  highlight_big_folders = function(size_regex, parent_el) {
    if (parent_el == null) {
      parent_el = $('#folders');
    }
    return parent_el.children().children('.size').each(function() {
      highlight_folder(size_regex, $(this));
      if ($(this).parent().data('open')) {
        return highlight_big_folders(size_regex, $(this).parent().next('div'));
      }
    });
  };

}).call(this);
